---
layout: post
title: 선언형 방식으로 쿠버네티스 다루기
categories: ['kubernetes']
category: 'Kubernetes'
origins: ['https://www.udemy.com/course/docker-kubernetes-2022/']
published: true
---

# deployment.yaml

[공식 문서](https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/)

## apiVersion

쿠버네티스도 꾸준히 버전업이 되고 있는 중이기 때문에,<br>
이전 버전에서 deployment.yaml 에 선언된 키워드를 사용할 수 없을 수도 있다.

이런 문제를 방지하기 위해서 `apiVersion` 을 지정해야한다.

[버전 확인](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/)

```
appVersion: apps/v1
```

## kind

지금 사용하는 이 `deployment.yaml` 파일이 어떤 목적인지를 알려줘야한다.<br>
파일 이름이 `deployment.yaml` 라고 해서 쿠버네티스가 deployment 에 관한 파일이구나 하고 인지하지 못하기 때문이다

```
kind: Deployment
```

## metadata

deployment 에 대한 메타 데이터를 정의할 수 있다.

### name

deployment 의 이름이다.

```
metadata:
    name: second-app-deployment
```

## spec

deployment 의 사양을 정의할 수 있다.

### replicas

default 로 생성될 pod 의 수를 지정할 수 있다.<br>
정의하지 않으면 1 로 자동설정된다.<br>

처음에 pod 가 실행되는 걸 원하지 않는다면 0으로 값을 줄 수도 있다.

```
spec:
    replicas: 2
```

### template

pod 에 대한 정의를 할 수 있다.

#### metadata

pod 에 대한 메타 데이터를 정의할 수 있다.

##### labels

pod 에 대한 이름을 정의할 수 있다.

```
spec:
    template:
        metadata:
            labels:
```

#### spec

pod 에 대한 사양을 정의할 수 있다.

##### containers

pod 내부의 컨테이너에 대해 정의할 수 있다.

###### name

컨테이너의 이름이다.

```
spec:
    template:
        spec:
            metadata:
                labels:
                    - name: node-app
```

###### image

컨테이너에 사용될 이미지를 정의할 수 있다.

```
spec:
    template:
        spec:
            metadata:
                labels:
                    - name: node-app
                      image: academind/kub-first-app:2
```

# deployment.yaml 적용하기

```
kubectl apply -f=deployment.yaml
```
